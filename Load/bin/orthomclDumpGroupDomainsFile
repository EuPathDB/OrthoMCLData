# this file needs to be turned into a real script to create the download file.
# here is the sql to use

SELECT name as Orthomcl_Group, primary_identifier as Pfam_Name, round(count(aa_sequence_id)/number_of_members,4) as Frequency from (
SELECT distinct og.name, db.primary_identifier, ogs.aa_sequence_id, og.number_of_members
FROM apidb.OrthologGroupAaSequence ogs,
apidb.OrthologGroup og,
dots.DomainFeature df,
dots.DbRefAaFeature dbaf,
sres.DbRef db,
dots.aalocation al
WHERE og.ortholog_group_id != 0 
AND ogs.ortholog_group_id = og.ortholog_group_id
AND df.aa_sequence_id = ogs.aa_sequence_id
AND dbaf.aa_feature_id = df.aa_feature_id
AND db.db_ref_id = dbaf.db_ref_id
AND al.aa_feature_id = df.aa_feature_id)
group by name, number_of_members, primary_identifier
ORDER BY name, frequency desc
